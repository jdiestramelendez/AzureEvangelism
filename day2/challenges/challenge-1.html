<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Challenge 1 - Azure Web Apps | Azure Developer College</title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="">
    <link rel="preload" href="/trainingdays/assets/css/0.styles.737a609d.css" as="style"><link rel="preload" href="/trainingdays/assets/js/app.979c6b7a.js" as="script"><link rel="preload" href="/trainingdays/assets/js/2.946afb25.js" as="script"><link rel="preload" href="/trainingdays/assets/js/8.4a846293.js" as="script"><link rel="prefetch" href="/trainingdays/assets/js/10.579b3943.js"><link rel="prefetch" href="/trainingdays/assets/js/11.d4c47101.js"><link rel="prefetch" href="/trainingdays/assets/js/12.590646ab.js"><link rel="prefetch" href="/trainingdays/assets/js/13.291f1baa.js"><link rel="prefetch" href="/trainingdays/assets/js/14.78e58adc.js"><link rel="prefetch" href="/trainingdays/assets/js/15.43a7d4b3.js"><link rel="prefetch" href="/trainingdays/assets/js/16.dbdf25fb.js"><link rel="prefetch" href="/trainingdays/assets/js/17.042a82f5.js"><link rel="prefetch" href="/trainingdays/assets/js/18.8fc9a76b.js"><link rel="prefetch" href="/trainingdays/assets/js/19.ba0301ce.js"><link rel="prefetch" href="/trainingdays/assets/js/20.d35e0501.js"><link rel="prefetch" href="/trainingdays/assets/js/21.9cf29e76.js"><link rel="prefetch" href="/trainingdays/assets/js/22.8f65c66f.js"><link rel="prefetch" href="/trainingdays/assets/js/23.63b1464a.js"><link rel="prefetch" href="/trainingdays/assets/js/24.f2b050d0.js"><link rel="prefetch" href="/trainingdays/assets/js/25.888e995e.js"><link rel="prefetch" href="/trainingdays/assets/js/26.615c6e2b.js"><link rel="prefetch" href="/trainingdays/assets/js/27.2fac82c6.js"><link rel="prefetch" href="/trainingdays/assets/js/28.15973f8c.js"><link rel="prefetch" href="/trainingdays/assets/js/29.8147889d.js"><link rel="prefetch" href="/trainingdays/assets/js/3.ad045b8a.js"><link rel="prefetch" href="/trainingdays/assets/js/30.9c2dd52a.js"><link rel="prefetch" href="/trainingdays/assets/js/31.d841ed10.js"><link rel="prefetch" href="/trainingdays/assets/js/32.be2adea9.js"><link rel="prefetch" href="/trainingdays/assets/js/33.a7ee4127.js"><link rel="prefetch" href="/trainingdays/assets/js/34.ecf3f8cf.js"><link rel="prefetch" href="/trainingdays/assets/js/35.29b4b3f9.js"><link rel="prefetch" href="/trainingdays/assets/js/36.318a4ca5.js"><link rel="prefetch" href="/trainingdays/assets/js/37.5f18efe5.js"><link rel="prefetch" href="/trainingdays/assets/js/38.831871c9.js"><link rel="prefetch" href="/trainingdays/assets/js/39.5aa41377.js"><link rel="prefetch" href="/trainingdays/assets/js/4.6fa698a8.js"><link rel="prefetch" href="/trainingdays/assets/js/40.63c32c81.js"><link rel="prefetch" href="/trainingdays/assets/js/41.588fb663.js"><link rel="prefetch" href="/trainingdays/assets/js/42.41be88c0.js"><link rel="prefetch" href="/trainingdays/assets/js/43.86bdbeb7.js"><link rel="prefetch" href="/trainingdays/assets/js/44.e2871805.js"><link rel="prefetch" href="/trainingdays/assets/js/45.fda8ac03.js"><link rel="prefetch" href="/trainingdays/assets/js/46.c7b2de4e.js"><link rel="prefetch" href="/trainingdays/assets/js/47.3853555d.js"><link rel="prefetch" href="/trainingdays/assets/js/48.349de7cd.js"><link rel="prefetch" href="/trainingdays/assets/js/49.fa90df63.js"><link rel="prefetch" href="/trainingdays/assets/js/5.52a0f081.js"><link rel="prefetch" href="/trainingdays/assets/js/50.4ea84d6d.js"><link rel="prefetch" href="/trainingdays/assets/js/51.e2251628.js"><link rel="prefetch" href="/trainingdays/assets/js/52.95cbed17.js"><link rel="prefetch" href="/trainingdays/assets/js/53.03f3b5cb.js"><link rel="prefetch" href="/trainingdays/assets/js/54.ef926d4f.js"><link rel="prefetch" href="/trainingdays/assets/js/55.984b5e4c.js"><link rel="prefetch" href="/trainingdays/assets/js/56.bbd534a5.js"><link rel="prefetch" href="/trainingdays/assets/js/57.ea603655.js"><link rel="prefetch" href="/trainingdays/assets/js/58.1ef54c85.js"><link rel="prefetch" href="/trainingdays/assets/js/59.5b592a5f.js"><link rel="prefetch" href="/trainingdays/assets/js/6.b627fb7f.js"><link rel="prefetch" href="/trainingdays/assets/js/60.8f359445.js"><link rel="prefetch" href="/trainingdays/assets/js/61.86b9e948.js"><link rel="prefetch" href="/trainingdays/assets/js/62.d1ab47f9.js"><link rel="prefetch" href="/trainingdays/assets/js/63.9095cfe3.js"><link rel="prefetch" href="/trainingdays/assets/js/64.5775d1f6.js"><link rel="prefetch" href="/trainingdays/assets/js/65.3f520961.js"><link rel="prefetch" href="/trainingdays/assets/js/66.1b02a586.js"><link rel="prefetch" href="/trainingdays/assets/js/67.ce277927.js"><link rel="prefetch" href="/trainingdays/assets/js/68.b9714970.js"><link rel="prefetch" href="/trainingdays/assets/js/69.2d7bfe65.js"><link rel="prefetch" href="/trainingdays/assets/js/7.e5967278.js"><link rel="prefetch" href="/trainingdays/assets/js/70.96513052.js"><link rel="prefetch" href="/trainingdays/assets/js/71.91e4366c.js"><link rel="prefetch" href="/trainingdays/assets/js/72.6e5ac371.js"><link rel="prefetch" href="/trainingdays/assets/js/73.eda0c95a.js"><link rel="prefetch" href="/trainingdays/assets/js/74.10699d20.js"><link rel="prefetch" href="/trainingdays/assets/js/75.035a3484.js"><link rel="prefetch" href="/trainingdays/assets/js/9.6fbed640.js">
    <link rel="stylesheet" href="/trainingdays/assets/css/0.styles.737a609d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/trainingdays/" class="home-link router-link-active"><!----> <span class="site-name">Azure Developer College</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/azuredevcollege/trainingdays" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/azuredevcollege/trainingdays" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/trainingdays/" aria-current="page" class="sidebar-link">Home</a></li><li><a href="/trainingdays/day1/" class="sidebar-link">Day 1 Azure Fundamentals &amp; Infrastructure</a></li><li><a href="/trainingdays/day2/" aria-current="page" class="sidebar-link">Day 2 Azure Development</a></li><li><a href="/trainingdays/day3/" class="sidebar-link">Day 3 Data and AI</a></li><li><a href="/trainingdays/day4/" class="sidebar-link">Day 4 Azure DevOps</a></li><li><a href="/trainingdays/day5/" class="sidebar-link">Day 5 Identity and Architecture</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="challenge-1-azure-web-apps"><a href="#challenge-1-azure-web-apps" class="header-anchor">#</a> Challenge 1 - Azure Web Apps</h1> <h2 id="here-is-what-you-will-learn"><a href="#here-is-what-you-will-learn" class="header-anchor">#</a> Here is what you will learn</h2> <ul><li>Create an AppService Plan / Azure Web App</li> <li>Create and deploy an ASP.NET Core Web App to Azure</li> <li>Create and configure WebApp slots</li> <li>Use slots to deploy new versions of your web application with near-zero downtime</li></ul> <h2 id="create-an-azure-web-app"><a href="#create-an-azure-web-app" class="header-anchor">#</a> Create an Azure Web App</h2> <h3 id="option-1-azure-portal"><a href="#option-1-azure-portal" class="header-anchor">#</a> Option 1: Azure Portal</h3> <p>To create an Azure Web App, go to the Azure Portal and click on <strong>&quot;Create a resource&quot;</strong>, in the next view choose <strong>&quot;Web App&quot;</strong>.</p> <p><img src="/trainingdays/assets/img/portal_createresources.cca835dc.png" alt="create" title="create"></p> <p>When you reached the &quot;Create Web App&quot; wizard, follow the steps below:</p> <ul><li>Choose the correct subscription</li> <li>Create a new resource group, name it &quot;myFirstWebApps-rg&quot;</li> <li>Under instance details, enter a name for your Web App (be careful: this must be a global unique name!)</li> <li>Publish: Code</li> <li>Runtime: .NET Core 3.1 (LTS)</li> <li>Operation System: Windows</li> <li>Region: West Europe</li> <li>create a new AppSerice plan
<ul><li>SKU and Size: S1</li> <li>To get familiar with other sizes, click &quot;Change size&quot;</li></ul></li></ul> <p>Click &quot;Next: Monitoring&quot;.</p> <ul><li>Enable AppInsights</li> <li>Create a new AppInsights instance for it</li></ul> <p>When done, proceed to the &quot;Review + create&quot; screen.</p> <p><img src="/trainingdays/assets/img/portal_webapp.c40cbc2b.png" alt="review" title="review"></p> <p>Again, check that all the properties are filled with the expected values and click &quot;Create&quot;.</p> <p>When the deployment has finished, got to the resource and get familiar with all the configuration options discussed in the introduction talk.</p> <p><img src="/trainingdays/assets/img/portal_webappoverview.d2e6f604.png" alt="overview" title="overview"></p> <p>Open the web app in your browser.</p> <p><img src="/trainingdays/assets/img/browser_webapp.291cc7ac.png" alt="browser" title="browser"></p> <h3 id="option-2-azure-cli"><a href="#option-2-azure-cli" class="header-anchor">#</a> Option 2: Azure CLI</h3> <p>If you have created the web application already with option 1, go to the portal and delete the resource group - including all the newly created resources (you have to wait until it has finished, before proceeding). We will be creating the exact same resources now with the Azure CLI.</p> <p>First, let's create the resource group.</p> <blockquote><p>BTW: You can check the results of each command in the Portal.</p></blockquote> <div class="language-shell extra-class"><pre class="language-shell"><code>$ az group create --name myFirstWebApps-rg --location westeurope

<span class="token punctuation">{</span>
  <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/myFirstWebApps-rg&quot;</span>,
  <span class="token string">&quot;location&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;westeurope&quot;</span>,
  <span class="token string">&quot;managedBy&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myFirstWebApps-rg&quot;</span>,
  <span class="token string">&quot;properties&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;provisioningState&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Succeeded&quot;</span>
  <span class="token punctuation">}</span>,
  <span class="token string">&quot;tags&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Microsoft.Resources/resourceGroups&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Next, add an App Service Plan.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ az appservice plan create -g myFirstWebApps-rg -n myFirstWebAppsPlan --sku S1

<span class="token punctuation">{</span>
  <span class="token string">&quot;freeOfferExpirationTime&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;geoRegion&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;West Europe&quot;</span>,
  <span class="token string">&quot;hostingEnvironmentProfile&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;hyperV&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/myFirstWebApps-rg/providers/Microsoft.Web/serverfarms/myFirstWebAppsPlan&quot;</span>,
  <span class="token string">&quot;isSpot&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;isXenon&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;kind&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;app&quot;</span>,
  <span class="token string">&quot;location&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;West Europe&quot;</span>,
  <span class="token string">&quot;maximumElasticWorkerCount&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span>,
  <span class="token string">&quot;maximumNumberOfWorkers&quot;</span><span class="token builtin class-name">:</span> <span class="token number">10</span>,
  <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myFirstWebAppsPlan&quot;</span>,
  <span class="token string">&quot;numberOfSites&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
  <span class="token string">&quot;perSiteScaling&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;provisioningState&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Succeeded&quot;</span>,
  <span class="token string">&quot;reserved&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;resourceGroup&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myFirstWebApps-rg&quot;</span>,
  <span class="token string">&quot;sku&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;capabilities&quot;</span><span class="token builtin class-name">:</span> null,
    <span class="token string">&quot;capacity&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span>,
    <span class="token string">&quot;family&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;S&quot;</span>,
    <span class="token string">&quot;locations&quot;</span><span class="token builtin class-name">:</span> null,
    <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;S1&quot;</span>,
    <span class="token string">&quot;size&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;S1&quot;</span>,
    <span class="token string">&quot;skuCapacity&quot;</span><span class="token builtin class-name">:</span> null,
    <span class="token string">&quot;tier&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Standard&quot;</span>
  <span class="token punctuation">}</span>,
  <span class="token string">&quot;spotExpirationTime&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;status&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Ready&quot;</span>,
  <span class="token string">&quot;subscription&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span>,
  <span class="token string">&quot;tags&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;targetWorkerCount&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
  <span class="token string">&quot;targetWorkerSizeId&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
  <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Microsoft.Web/serverfarms&quot;</span>,
  <span class="token string">&quot;workerTierName&quot;</span><span class="token builtin class-name">:</span> null
<span class="token punctuation">}</span>
</code></pre></div><p>When the App Service Plan has been created, we can now add the Web App.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ az webapp create -g myFirstWebApps-rg -p myFirstWebAppsPlan -n myFirstWebAppDevCollege

<span class="token punctuation">{</span>
  <span class="token string">&quot;availabilityState&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Normal&quot;</span>,
  <span class="token string">&quot;clientAffinityEnabled&quot;</span><span class="token builtin class-name">:</span> true,
  <span class="token string">&quot;clientCertEnabled&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;clientCertExclusionPaths&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;cloningInfo&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;containerSize&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
  <span class="token string">&quot;dailyMemoryTimeQuota&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
  <span class="token string">&quot;defaultHostName&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myfirstwebappdevcollege.azurewebsites.net&quot;</span>,
  <span class="token string">&quot;enabled&quot;</span><span class="token builtin class-name">:</span> true,
  <span class="token string">&quot;enabledHostNames&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;myfirstwebappdevcollege.azurewebsites.net&quot;</span>,
    <span class="token string">&quot;myfirstwebappdevcollege.scm.azurewebsites.net&quot;</span>
  <span class="token punctuation">]</span>,
  <span class="token string">&quot;ftpPublishingUrl&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ftp://waws-prod-am2-217.ftp.azurewebsites.windows.net/site/wwwroot&quot;</span>,
  <span class="token string">&quot;geoDistributions&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;hostNameSslStates&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;hostType&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Standard&quot;</span>,
      <span class="token string">&quot;ipBasedSslResult&quot;</span><span class="token builtin class-name">:</span> null,
      <span class="token string">&quot;ipBasedSslState&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;NotConfigured&quot;</span>,
      <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myfirstwebappdevcollege.azurewebsites.net&quot;</span>,
      <span class="token string">&quot;sslState&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Disabled&quot;</span>,
      <span class="token string">&quot;thumbprint&quot;</span><span class="token builtin class-name">:</span> null,
      <span class="token string">&quot;toUpdate&quot;</span><span class="token builtin class-name">:</span> null,
      <span class="token string">&quot;toUpdateIpBasedSsl&quot;</span><span class="token builtin class-name">:</span> null,
      <span class="token string">&quot;virtualIp&quot;</span><span class="token builtin class-name">:</span> null
    <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span>
      <span class="token string">&quot;hostType&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Repository&quot;</span>,
      <span class="token string">&quot;ipBasedSslResult&quot;</span><span class="token builtin class-name">:</span> null,
      <span class="token string">&quot;ipBasedSslState&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;NotConfigured&quot;</span>,
      <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myfirstwebappdevcollege.scm.azurewebsites.net&quot;</span>,
      <span class="token string">&quot;sslState&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Disabled&quot;</span>,
      <span class="token string">&quot;thumbprint&quot;</span><span class="token builtin class-name">:</span> null,
      <span class="token string">&quot;toUpdate&quot;</span><span class="token builtin class-name">:</span> null,
      <span class="token string">&quot;toUpdateIpBasedSsl&quot;</span><span class="token builtin class-name">:</span> null,
      <span class="token string">&quot;virtualIp&quot;</span><span class="token builtin class-name">:</span> null
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>,
  <span class="token string">&quot;hostNames&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;myfirstwebappdevcollege.azurewebsites.net&quot;</span>
  <span class="token punctuation">]</span>,
  <span class="token string">&quot;hostNamesDisabled&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;hostingEnvironmentProfile&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;httpsOnly&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;hyperV&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/myFirstWebApps-rg/providers/Microsoft.Web/sites/myFirstWebAppDevCollege&quot;</span>,
  <span class="token string">&quot;identity&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;inProgressOperationId&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;isDefaultContainer&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;isXenon&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;kind&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;app&quot;</span>,
  <span class="token string">&quot;lastModifiedTimeUtc&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2020-01-13T13:17:15.623333&quot;</span>,
  <span class="token string">&quot;location&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;West Europe&quot;</span>,
  <span class="token string">&quot;maxNumberOfWorkers&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myFirstWebAppDevCollege&quot;</span>,
  <span class="token string">&quot;outboundIpAddresses&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;137.117.218.101,137.117.210.101,137.117.214.210,137.117.214.88,137.117.212.13&quot;</span>,
  <span class="token string">&quot;possibleOutboundIpAddresses&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;137.117.218.101,137.117.210.101,137.117.214.210,137.117.214.88,137.117.212.13,137.117.208.108,137.117.208.41,137.117.211.152&quot;</span>,
  <span class="token string">&quot;redundancyMode&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;None&quot;</span>,
  <span class="token string">&quot;repositorySiteName&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myFirstWebAppDevCollege&quot;</span>,
  <span class="token string">&quot;reserved&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;resourceGroup&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myFirstWebApps-rg&quot;</span>,
  <span class="token string">&quot;scmSiteAlsoStopped&quot;</span><span class="token builtin class-name">:</span> false,
  <span class="token string">&quot;serverFarmId&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/myFirstWebApps-rg/providers/Microsoft.Web/serverfarms/myFirstWebAppsPlan&quot;</span>,
  <span class="token string">&quot;siteConfig&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;slotSwapStatus&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;state&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Running&quot;</span>,
  <span class="token string">&quot;suspendedTill&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;tags&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;targetSwapSlot&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;trafficManagerHostNames&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Microsoft.Web/sites&quot;</span>,
  <span class="token string">&quot;usageState&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Normal&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The last step we need to have the same environment like when we created everything via the portal, is to add Application Insights.</p> <p>The Azure CLI Application Insights component is still in preview. To access it, you first need to run:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ az extension <span class="token function">add</span> -n application-insights

The installed extension <span class="token string">'application-insights'</span> is <span class="token keyword">in</span> preview.
</code></pre></div><p>Now, let's create the AppInsights component for our application.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ az monitor app-insights component create --app myFirstWebAppsAppIn --location westeurope --kind web -g myFirstWebApps-rg  --application-type web

<span class="token punctuation">{</span>
  <span class="token string">&quot;appId&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;14f1a266-629c-44aa-ad0f-9e09bed00f71&quot;</span>,
  <span class="token string">&quot;applicationId&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myFirstWebAppsAppIn&quot;</span>,
  <span class="token string">&quot;applicationType&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;web&quot;</span>,
  <span class="token string">&quot;creationDate&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2020-01-13T06:23:58.761173+00:00&quot;</span>,
  <span class="token string">&quot;etag&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;<span class="token entity" title="\&quot;">\&quot;</span>0500a71d-0000-0200-0000-5e1c0cfe0000<span class="token entity" title="\&quot;">\&quot;</span>&quot;</span>,
  <span class="token string">&quot;flowType&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Bluefield&quot;</span>,
  <span class="token string">&quot;hockeyAppId&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;hockeyAppToken&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/myFirstWebApps-rg/providers/microsoft.insights/components/myFirstWebAppsAppIn&quot;</span>,
  <span class="token string">&quot;instrumentationKey&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;8bfd7511-d6ad-4ea8-9a10-d0db786ec415&quot;</span>,
  <span class="token string">&quot;kind&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;web&quot;</span>,
  <span class="token string">&quot;location&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;westeurope&quot;</span>,
  <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myFirstWebAppsAppIn&quot;</span>,
  <span class="token string">&quot;provisioningState&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Succeeded&quot;</span>,
  <span class="token string">&quot;requestSource&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;rest&quot;</span>,
  <span class="token string">&quot;resourceGroup&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;myFirstWebApps-rg&quot;</span>,
  <span class="token string">&quot;samplingPercentage&quot;</span><span class="token builtin class-name">:</span> null,
  <span class="token string">&quot;tags&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>,
  <span class="token string">&quot;tenantId&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span>,
  <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;microsoft.insights/components&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Add the Application Insights instrumentation key to your WebApp. Therefore, use the instrumentation key from the above output in the next command.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ az webapp config appsettings <span class="token builtin class-name">set</span> --settings <span class="token assign-left variable">APPINSIGHTS_INSTRUMENTATIONKEY</span><span class="token operator">=</span><span class="token operator">&lt;</span>YOUR_INSTRUMENTATION_KEY<span class="token operator">&gt;</span> -n myFirstWebAppDevCollege -g myFirstWebApps-rg
</code></pre></div><p>Now, we are all set to add a sample application.</p> <h2 id="create-a-sample-application"><a href="#create-a-sample-application" class="header-anchor">#</a> Create a sample application</h2> <p>We will use a .NET Core MVC application to demonstrate the deployment process to an Azure Web App. So first, let's create a demo application.</p> <p>Create a local folder called <em>devcollege</em> and open it in the comannd line. CD into that folder and execute:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ dotnet new mvc -o myFirstCoreApp

The template <span class="token string">&quot;ASP.NET Core Web App (Model-View-Controller)&quot;</span> was created successfully.
This template contains technologies from parties other than Microsoft, see https://aka.ms/aspnetcore/3.0-third-party-notices <span class="token keyword">for</span> details.

Processing post-creation actions<span class="token punctuation">..</span>.
Running <span class="token string">'dotnet restore'</span> on myFirstCoreApp/myFirstCoreApp.csproj<span class="token punctuation">..</span>.
  Restore completed <span class="token keyword">in</span> <span class="token number">60.34</span> ms <span class="token keyword">for</span> /Users/christiandennig/dev/myFirstCoreApp/myFirstCoreApp.csproj.

Restore succeeded.
</code></pre></div><h3 id="visual-studio-code"><a href="#visual-studio-code" class="header-anchor">#</a> Visual Studio Code</h3> <p>After the wizard has finished, cd into the new folder <em>myFirstCoreApp</em> and open it in VS Code:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ code <span class="token builtin class-name">.</span>
</code></pre></div><p><img src="/trainingdays/assets/img/vscode_start.9ed3aa8a.png" alt="vscode" title="vscode"></p> <p>Get familiar with the environment and have a look at the controller HomeController.</p> <p>Set a breakpoint (F9) on method <strong>public IActionResult Index()</strong> in Controllers/HomeController.cs</p> <p>Press F5 - if VS Code asks you about the environment, choose <em>.NET Core</em></p> <p>The project will now be built and after that, your browser will point to <em>https:/localhost:5001</em>.</p> <h4 id="optional-workaround"><a href="#optional-workaround" class="header-anchor">#</a> Optional / Workaround</h4> <blockquote><p>Here is a workaround, if port <em>5001</em> is blocked on your machine.</p></blockquote> <p>Open file <em>launch.json</em> in the folder <em>.vscode</em> and add the env variable <strong>ASPNETCORE_URLS</strong> with a value that works for you.</p> <p>Example:</p> <p><img src="/trainingdays/assets/img/vscode_launch.6ec5790e.png" alt="vscode-launch" title="vscode-launch"></p> <h3 id="debug-tools"><a href="#debug-tools" class="header-anchor">#</a> Debug Tools</h3> <p>When the breakpoint gets hit, get familiar with the tools of the debugger.</p> <p><img src="/trainingdays/assets/img/vscode_debug.af638ed5.png" alt="vscode-debug" title="vscode-debug"></p> <p>Open <em>Views/Home/Index.cshtml</em> and change the welcome text to &quot;Welcome to the Azure Developer College&quot;.</p> <p>Run it again locally and check, if the changes appear.</p> <p><img src="/trainingdays/assets/img/browser_welcome.918b7a1b.png" alt="browser-welcome" title="browser-welcome"></p> <h2 id="deploy-the-sample-app-to-azure"><a href="#deploy-the-sample-app-to-azure" class="header-anchor">#</a> Deploy the sample app to Azure</h2> <p>Now let's deploy the webapp to Azure.</p> <p>If you haven't done so far, add the Azure App Service Extension (see: <a href="/trainingdays/day2/challenges/challenge-0.html">Challenge 0 - Setup your system</a>)</p> <p>Find your webapp in the extension and right-click --&gt; Deploy to Web App...</p> <blockquote><p>If you can't find your subscription, press <strong>F1</strong> and choose the Task <em>Azure: Sign In</em>.</p></blockquote> <p><img src="/trainingdays/assets/img/vscode_deploy.9409d3ec.png" alt="vscode-deploy" title="vscode-deploy"></p> <p><img src="/trainingdays/assets/img/vscode_deploying.4a0e940d.png" alt="vscode-deploying" title="vscode-deploying"></p> <p>After a few seconds the browser will show you your first web app running in Azure.</p> <p><img src="/trainingdays/assets/img/browser_webappdevcollege.4f9eeca7.png" alt="browser-webapp" title="browser-webapp"></p> <h2 id="working-with-deployment-slots"><a href="#working-with-deployment-slots" class="header-anchor">#</a> Working with Deployment Slots</h2> <p>Open your web app in the portal and go to &quot;Deployment Slots&quot;.</p> <p>Create a new slot called &quot;Staging&quot; (choose clone settings from your production slot).</p> <p><img src="/trainingdays/assets/img/portal_staging.1f4c988f.png" alt="portal-staging" title="portal-staging"></p> <p>When finished, go back to VS Code.</p> <h2 id="deploy-sample-application-to-staging-slot"><a href="#deploy-sample-application-to-staging-slot" class="header-anchor">#</a> Deploy sample application to Staging slot</h2> <p>Open <em>Views/Home/Index.cshtml</em> again and change the welcome text to &quot;Welcome to the Azure Developer College - this time with slots!&quot;.</p> <p>Check that your local development environment works as expected.</p> <p><img src="/trainingdays/assets/img/browser_staging.8e486aff.png" alt="browser-staging" title="browser-staging"></p> <p>To deploy the application to the <strong>Staging</strong> slot, find your webapp in the <strong>Azure AppService extension</strong>, drill down to <strong>Deployment Slots</strong> and right-click --&gt; Deploy to Slot...</p> <p>Your current application will now be deployed to your &quot;Staging&quot; slot.</p> <h3 id="show-staging-application"><a href="#show-staging-application" class="header-anchor">#</a> Show Staging application</h3> <p>To see your staging slot in action, go to the slot in the portal and copy the URL in the overview blade.</p> <p><img src="/trainingdays/assets/img/portal_slotoverview.8d998fe9.png" alt="portal-slot-overview" title="portal-slot-overview"></p> <p>Open your browser, navigate to the URL and check, if the headline contains the new text.</p> <p><img src="/trainingdays/assets/img/browser_slotwebsite.ed889f3e.png" alt="browser-slot-website" title="browser-slot-website"></p> <blockquote><p>Also check the production slot (URL without &quot;-staging&quot;).</p></blockquote> <h3 id="swapping-slots"><a href="#swapping-slots" class="header-anchor">#</a> Swapping Slots</h3> <p>Now that everything works as expected, go back to &quot;Deployment Slots&quot; and click on &quot;Swap&quot; (selecting the staging slot as source).</p> <p>With this command, we are swapping the current &quot;poduction&quot; slot with our &quot;Staging&quot; slot...which basically means that the Load Balancer in front of our Web App points to &quot;Staging&quot; and promotes it as the new &quot;production&quot; slot.</p> <p><img src="/trainingdays/assets/img/portal_swap.e989c257.png" alt="portal-swap" title="portal-swap"></p> <p>Now check, that the production slot serves the new version of the website.</p> <blockquote><p><strong>Optional</strong>: Split traffic 50:50 to staging and production a see what happens when you reload your page in the browser pointing to the <em>production</em> slot. What do you think, why does this happen??</p></blockquote> <h2 id="house-keeping"><a href="#house-keeping" class="header-anchor">#</a> House Keeping</h2> <p>Remove the sample resource group.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ az group delete -n myFirstWebApps-rg
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/azuredevcollege/trainingdays/edit/master/day2/challenges/challenge-1.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/trainingdays/assets/js/app.979c6b7a.js" defer></script><script src="/trainingdays/assets/js/2.946afb25.js" defer></script><script src="/trainingdays/assets/js/8.4a846293.js" defer></script>
  </body>
</html>
